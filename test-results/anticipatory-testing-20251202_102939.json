{
  "timestamp": "2025-12-02T10:29:38.054806",
  "test_type": "anticipatory_testing",
  "project_root": "/Users/peter/github/opencode-workflow-kit",
  "suites": {
    "integration_contracts": {
      "tests_run": 0,
      "failures": 0,
      "errors": 1,
      "success_rate": 0,
      "parsed_output": false,
      "suite_name": "integration_contracts",
      "success": false,
      "duration_seconds": 1.1360409259796143,
      "critical": true,
      "stdout": "\ud83e\uddea Running Integration Contract Tests\n==================================================\n\n\ud83d\udcca Test Results:\n  Tests run: 15\n  Failures: 3\n  Errors: 2\n  Success rate: 66.7%\n\n\u274c Failures:\n  \u2022 test_beads_version_contract (__main__.TestBeadsContract): expected call not found.\nExpected: run(['bd', '--version'], check=True, capture_output=True, timeout=5)\nActual: run(['bd', '--version'], check=True, capture_output=True, timeout=5, cwd=PosixPath('/var/folders/n6/4nb1pqwj7gl675t1jvxlml_m0000gn/T/tmp3hobh8gb'))\n  \u2022 test_cody_feature_backlog_contract (__main__.TestCodyContract): '\ud83d\udd34' not found in '# Feature Backlog\\n\\nThis document lists features and enhancements derived from plan.\\n\\n## Backlog\\n\\n| ID  | Feature             | Description                               | Priority | Status |\\n|-----|---------------------|-------------------------------------------|----------|--------|\\n| owk-1 | Test feature | Test description | High | \ud83d\udfe2 |\\n| owk-2 | Another feature | Another description | Medium | \ud83d\udfe1 |\\n' : Should include status indicator: \ud83d\udd34\n  \u2022 test_graceful_degradation_contract (__main__.TestIntegrationContract): True is not false : Should report beads as unavailable\n\n\ud83d\udca5 Errors:\n  \u2022 test_non_blocking_contract (__main__.TestIntegrationContract): Traceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 432, in test_non_blocking_contract\n    result = method(*args) if args else method()\nTypeError: handle_post_commit() takes 2 positional arguments but 7 were given\n  \u2022 test_beads_jsonl_contract_violation (__main__.TestContractViolations): Traceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 465, in test_beads_jsonl_contract_violation\n    self.adapter._validate_beads_issue_contract(invalid_issue, 1)\nAttributeError: 'CodyBeadsAdapter' object has no attribute '_validate_beads_issue_contract'\n\n\ud83d\udcc4 Results saved to: test-results/integration-contracts-20251202_102939.json\n",
      "stderr": "test_beads_data_format_contract (__main__.TestBeadsContract)\nTest Beads JSONL follows expected data format. ... ok\ntest_beads_version_contract (__main__.TestBeadsContract)\nTest bd --version follows expected contract. ... FAIL\ntest_beads_version_failure (__main__.TestBeadsContract)\nTest graceful handling when bd command fails. ... ok\ntest_beads_version_missing (__main__.TestBeadsContract)\nTest graceful handling when bd command missing. ... ok\ntest_cody_agent_config_contract (__main__.TestCodyContract)\nTest Cody agent configurations follow expected format. ... ok\ntest_cody_feature_backlog_contract (__main__.TestCodyContract)\nTest Cody feature-backlog.md follows expected format. ... FAIL\ntest_cody_structure_contract (__main__.TestCodyContract)\nTest Cody PBT follows expected directory structure. ... ok\ntest_cody_structure_missing (__main__.TestCodyContract)\nTest graceful handling when Cody structure missing. ... ok\ntest_adapter_logging_contract (__main__.TestIntegrationContract)\nTest adapter logging follows expected format. ... ok\ntest_graceful_degradation_contract (__main__.TestIntegrationContract)\nTest graceful degradation when systems unavailable. ... FAIL\ntest_non_blocking_contract (__main__.TestIntegrationContract)\nTest integration operations never block. ... ERROR\ntest_system_status_contract (__main__.TestIntegrationContract)\nTest system status follows expected format. ... ok\ntest_beads_jsonl_contract_violation (__main__.TestContractViolations)\nTest detection of Beads JSONL contract violations. ... ERROR\ntest_cody_backlog_contract_violation (__main__.TestContractViolations)\nTest detection of Cody backlog contract violations. ... ok\ntest_version_compatibility_violation (__main__.TestContractViolations)\nTest detection of version compatibility violations. ... ok\n\n======================================================================\nERROR: test_non_blocking_contract (__main__.TestIntegrationContract)\nTest integration operations never block.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 432, in test_non_blocking_contract\n    result = method(*args) if args else method()\nTypeError: handle_post_commit() takes 2 positional arguments but 7 were given\n\n======================================================================\nERROR: test_beads_jsonl_contract_violation (__main__.TestContractViolations)\nTest detection of Beads JSONL contract violations.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 465, in test_beads_jsonl_contract_violation\n    self.adapter._validate_beads_issue_contract(invalid_issue, 1)\nAttributeError: 'CodyBeadsAdapter' object has no attribute '_validate_beads_issue_contract'\n\n======================================================================\nFAIL: test_beads_version_contract (__main__.TestBeadsContract)\nTest bd --version follows expected contract.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 54, in test_beads_version_contract\n    mock_run.assert_called_once_with(\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py\", line 919, in assert_called_once_with\n    return self.assert_called_with(*args, **kwargs)\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py\", line 907, in assert_called_with\n    raise AssertionError(_error_message()) from cause\nAssertionError: expected call not found.\nExpected: run(['bd', '--version'], check=True, capture_output=True, timeout=5)\nActual: run(['bd', '--version'], check=True, capture_output=True, timeout=5, cwd=PosixPath('/var/folders/n6/4nb1pqwj7gl675t1jvxlml_m0000gn/T/tmp3hobh8gb'))\n\n======================================================================\nFAIL: test_cody_feature_backlog_contract (__main__.TestCodyContract)\nTest Cody feature-backlog.md follows expected format.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 280, in test_cody_feature_backlog_contract\n    self.assertIn(status, content, f\"Should include status indicator: {status}\")\nAssertionError: '\ud83d\udd34' not found in '# Feature Backlog\\n\\nThis document lists features and enhancements derived from plan.\\n\\n## Backlog\\n\\n| ID  | Feature             | Description                               | Priority | Status |\\n|-----|---------------------|-------------------------------------------|----------|--------|\\n| owk-1 | Test feature | Test description | High | \ud83d\udfe2 |\\n| owk-2 | Another feature | Another description | Medium | \ud83d\udfe1 |\\n' : Should include status indicator: \ud83d\udd34\n\n======================================================================\nFAIL: test_graceful_degradation_contract (__main__.TestIntegrationContract)\nTest graceful degradation when systems unavailable.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 408, in test_graceful_degradation_contract\n    self.assertFalse(\nAssertionError: True is not false : Should report beads as unavailable\n\n----------------------------------------------------------------------\nRan 15 tests in 1.034s\n\nFAILED (failures=3, errors=2)\n",
      "error_details": "test_beads_data_format_contract (__main__.TestBeadsContract)\nTest Beads JSONL follows expected data format. ... ok\ntest_beads_version_contract (__main__.TestBeadsContract)\nTest bd --version follows expected contract. ... FAIL\ntest_beads_version_failure (__main__.TestBeadsContract)\nTest graceful handling when bd command fails. ... ok\ntest_beads_version_missing (__main__.TestBeadsContract)\nTest graceful handling when bd command missing. ... ok\ntest_cody_agent_config_contract (__main__.TestCodyContract)\nTest Cody agent configurations follow expected format. ... ok\ntest_cody_feature_backlog_contract (__main__.TestCodyContract)\nTest Cody feature-backlog.md follows expected format. ... FAIL\ntest_cody_structure_contract (__main__.TestCodyContract)\nTest Cody PBT follows expected directory structure. ... ok\ntest_cody_structure_missing (__main__.TestCodyContract)\nTest graceful handling when Cody structure missing. ... ok\ntest_adapter_logging_contract (__main__.TestIntegrationContract)\nTest adapter logging follows expected format. ... ok\ntest_graceful_degradation_contract (__main__.TestIntegrationContract)\nTest graceful degradation when systems unavailable. ... FAIL\ntest_non_blocking_contract (__main__.TestIntegrationContract)\nTest integration operations never block. ... ERROR\ntest_system_status_contract (__main__.TestIntegrationContract)\nTest system status follows expected format. ... ok\ntest_beads_jsonl_contract_violation (__main__.TestContractViolations)\nTest detection of Beads JSONL contract violations. ... ERROR\ntest_cody_backlog_contract_violation (__main__.TestContractViolations)\nTest detection of Cody backlog contract violations. ... ok\ntest_version_compatibility_violation (__main__.TestContractViolations)\nTest detection of version compatibility violations. ... ok\n\n======================================================================\nERROR: test_non_blocking_contract (__main__.TestIntegrationContract)\nTest integration operations never block.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 432, in test_non_blocking_contract\n    result = method(*args) if args else method()\nTypeError: handle_post_commit() takes 2 positional arguments but 7 were given\n\n======================================================================\nERROR: test_beads_jsonl_contract_violation (__main__.TestContractViolations)\nTest detection of Beads JSONL contract violations.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 465, in test_beads_jsonl_contract_violation\n    self.adapter._validate_beads_issue_contract(invalid_issue, 1)\nAttributeError: 'CodyBeadsAdapter' object has no attribute '_validate_beads_issue_contract'\n\n======================================================================\nFAIL: test_beads_version_contract (__main__.TestBeadsContract)\nTest bd --version follows expected contract.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 54, in test_beads_version_contract\n    mock_run.assert_called_once_with(\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py\", line 919, in assert_called_once_with\n    return self.assert_called_with(*args, **kwargs)\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py\", line 907, in assert_called_with\n    raise AssertionError(_error_message()) from cause\nAssertionError: expected call not found.\nExpected: run(['bd', '--version'], check=True, capture_output=True, timeout=5)\nActual: run(['bd', '--version'], check=True, capture_output=True, timeout=5, cwd=PosixPath('/var/folders/n6/4nb1pqwj7gl675t1jvxlml_m0000gn/T/tmp3hobh8gb'))\n\n======================================================================\nFAIL: test_cody_feature_backlog_contract (__main__.TestCodyContract)\nTest Cody feature-backlog.md follows expected format.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 280, in test_cody_feature_backlog_contract\n    self.assertIn(status, content, f\"Should include status indicator: {status}\")\nAssertionError: '\ud83d\udd34' not found in '# Feature Backlog\\n\\nThis document lists features and enhancements derived from plan.\\n\\n## Backlog\\n\\n| ID  | Feature             | Description                               | Priority | Status |\\n|-----|---------------------|-------------------------------------------|----------|--------|\\n| owk-1 | Test feature | Test description | High | \ud83d\udfe2 |\\n| owk-2 | Another feature | Another description | Medium | \ud83d\udfe1 |\\n' : Should include status indicator: \ud83d\udd34\n\n======================================================================\nFAIL: test_graceful_degradation_contract (__main__.TestIntegrationContract)\nTest graceful degradation when systems unavailable.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/peter/github/opencode-workflow-kit/scripts/test-integration-contracts.py\", line 408, in test_graceful_degradation_contract\n    self.assertFalse(\nAssertionError: True is not false : Should report beads as unavailable\n\n----------------------------------------------------------------------\nRan 15 tests in 1.034s\n\nFAILED (failures=3, errors=2)\n"
    }
  },
  "summary": {
    "total_suites": 1,
    "run_suites": 1,
    "passed_suites": 0,
    "failed_suites": 1,
    "critical_failures": 1,
    "total_tests": 0,
    "total_failures": 0,
    "total_errors": 1,
    "overall_success": false
  }
}