{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://opencode.ai/schemas/permissions.json",
  "title": "Permissions Configuration Schema",
  "description": "Schema for permission matrix configuration files",
  "type": "object",
  "required": [
    "version",
    "name",
    "description",
    "permissions"
  ],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Configuration version following semantic versioning"
    },
    "name": {
      "type": "string",
      "description": "Unique name for this configuration"
    },
    "description": {
      "type": "string",
      "description": "Human-readable description of the configuration"
    },
    "inherits": {
      "type": "string",
      "description": "Path to parent configuration file to inherit from"
    },
    "permissions": {
      "type": "object",
      "required": ["file_system"],
      "properties": {
        "file_system": {
          "type": "object",
          "required": ["read"],
          "properties": {
            "read": {
              "type": "object",
              "required": ["allowed"],
              "properties": {
                "allowed": {
                  "type": "boolean",
                  "description": "Whether read operations are allowed"
                },
                "paths": {
                  "type": "object",
                  "properties": {
                    "include": {
                      "type": "array",
                      "items": { "type": "string" },
                      "description": "Path patterns to include"
                    },
                    "exclude": {
                      "type": "array",
                      "items": { "type": "string" },
                      "description": "Path patterns to exclude"
                    }
                  }
                },
                "extensions": {
                  "type": "object",
                  "properties": {
                    "include": {
                      "type": "array",
                      "items": { "type": "string" },
                      "description": "File extensions to include"
                    },
                    "exclude": {
                      "type": "array",
                      "items": { "type": "string" },
                      "description": "File extensions to exclude"
                    }
                  }
                },
                "max_file_size": {
                  "type": "string",
                  "pattern": "^\\d+[KMGT]?B$",
                  "description": "Maximum file size for read operations"
                },
                "max_path_length": {
                  "type": "integer",
                  "minimum": 1,
                  "description": "Maximum path length"
                },
                "respect_gitignore": {
                  "type": "boolean",
                  "description": "Whether to respect .gitignore files"
                }
              }
            },
            "write": {
              "type": "object",
              "required": ["allowed"],
              "properties": {
                "allowed": {
                  "type": "boolean",
                  "description": "Whether write operations are allowed"
                },
                "paths": {
                  "type": "object",
                  "properties": {
                    "include": {
                      "type": "array",
                      "items": { "type": "string" }
                    },
                    "exclude": {
                      "type": "array",
                      "items": { "type": "string" }
                    }
                  }
                },
                "extensions": {
                  "type": "object",
                  "properties": {
                    "include": {
                      "type": "array",
                      "items": { "type": "string" }
                    },
                    "exclude": {
                      "type": "array",
                      "items": { "type": "string" }
                    }
                  }
                },
                "max_file_size": {
                  "type": "string",
                  "pattern": "^\\d+[KMGT]?B$"
                },
                "max_path_length": {
                  "type": "integer",
                  "minimum": 1
                },
                "require_confirmation": {
                  "type": "boolean",
                  "description": "Require confirmation before write operations"
                },
                "respect_gitignore": {
                  "type": "boolean"
                }
              }
            },
            "execute": {
              "type": "object",
              "required": ["allowed"],
              "properties": {
                "allowed": {
                  "type": "boolean"
                },
                "paths": {
                  "type": "object",
                  "properties": {
                    "include": {
                      "type": "array",
                      "items": { "type": "string" }
                    },
                    "exclude": {
                      "type": "array",
                      "items": { "type": "string" }
                    }
                  }
                },
                "require_confirmation": {
                  "type": "boolean"
                },
                "allowed_commands": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "Allowed executable commands"
                }
              }
            },
            "delete": {
              "type": "object",
              "required": ["allowed"],
              "properties": {
                "allowed": {
                  "type": "boolean"
                },
                "paths": {
                  "type": "object",
                  "properties": {
                    "include": {
                      "type": "array",
                      "items": { "type": "string" }
                    },
                    "exclude": {
                      "type": "array",
                      "items": { "type": "string" }
                    }
                  }
                },
                "require_confirmation": {
                  "type": "boolean"
                },
                "protect_system_files": {
                  "type": "boolean"
                },
                "protect_git_files": {
                  "type": "boolean"
                }
              }
            }
          }
        },
        "network": {
          "type": "object",
          "properties": {
            "outbound": {
              "type": "object",
              "properties": {
                "allowed": {
                  "type": "boolean"
                },
                "protocols": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "ports": {
                  "type": "array",
                  "items": { "type": "integer" }
                },
                "domains": {
                  "type": "object",
                  "properties": {
                    "allowlist": {
                      "type": "array",
                      "items": { "type": "string" }
                    },
                    "blocklist": {
                      "type": "array",
                      "items": { "type": "string" }
                    }
                  }
                },
                "max_request_size": {
                  "type": "string",
                  "pattern": "^\\d+[KMGT]?B$"
                },
                "timeout": {
                  "type": "integer",
                  "minimum": 1000
                },
                "require_confirmation": {
                  "type": "boolean"
                }
              }
            },
            "inbound": {
              "type": "object",
              "properties": {
                "allowed": {
                  "type": "boolean"
                },
                "protocols": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "ports": {
                  "type": "array",
                  "items": { "type": "integer" }
                }
              }
            }
          }
        },
        "system": {
          "type": "object",
          "properties": {
            "environment": {
              "type": "object",
              "properties": {
                "read": {
                  "type": "object",
                  "properties": {
                    "allowed": {
                      "type": "boolean"
                    },
                    "variables": {
                      "type": "object",
                      "properties": {
                        "allowlist": {
                          "type": "array",
                          "items": { "type": "string" }
                        },
                        "blocklist": {
                          "type": "array",
                          "items": { "type": "string" }
                        }
                      }
                    }
                  }
                },
                "write": {
                  "type": "object",
                  "properties": {
                    "allowed": {
                      "type": "boolean"
                    },
                    "variables": {
                      "type": "object",
                      "properties": {
                        "allowlist": {
                          "type": "array",
                          "items": { "type": "string" }
                        },
                        "blocklist": {
                          "type": "array",
                          "items": { "type": "string" }
                        }
                      }
                    }
                  }
                }
              }
            },
            "processes": {
              "type": "object",
              "properties": {
                "list": {
                  "type": "object",
                  "properties": {
                    "allowed": {
                      "type": "boolean"
                    }
                  }
                },
                "kill": {
                  "type": "object",
                  "properties": {
                    "allowed": {
                      "type": "boolean"
                    },
                    "require_confirmation": {
                      "type": "boolean"
                    },
                    "allowed_processes": {
                      "type": "array",
                      "items": { "type": "string" }
                    }
                  }
                },
                "start": {
                  "type": "object",
                  "properties": {
                    "allowed": {
                      "type": "boolean"
                    },
                    "require_confirmation": {
                      "type": "boolean"
                    },
                    "allowed_commands": {
                      "type": "array",
                      "items": { "type": "string" }
                    }
                  }
                }
              }
            }
          }
        },
        "git": {
          "type": "object",
          "properties": {
            "read": {
              "type": "object",
              "properties": {
                "allowed": {
                  "type": "boolean"
                },
                "commands": {
                  "type": "array",
                  "items": { "type": "string" }
                }
              }
            },
            "write": {
              "type": "object",
              "properties": {
                "allowed": {
                  "type": "boolean"
                },
                "commands": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "require_confirmation": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "protected_branches": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "require_branch_protection": {
                  "type": "boolean"
                }
              }
            }
          }
        },
        "mcp": {
          "type": "object",
          "properties": {
            "server_management": {
              "type": "object",
              "properties": {
                "start": {
                  "type": "object",
                  "properties": {
                    "allowed": {
                      "type": "boolean"
                    },
                    "servers": {
                      "type": "array",
                      "items": { "type": "string" }
                    }
                  }
                },
                "stop": {
                  "type": "object",
                  "properties": {
                    "allowed": {
                      "type": "boolean"
                    },
                    "servers": {
                      "type": "array",
                      "items": { "type": "string" }
                    }
                  }
                },
                "restart": {
                  "type": "object",
                  "properties": {
                    "allowed": {
                      "type": "boolean"
                    },
                    "servers": {
                      "type": "array",
                      "items": { "type": "string" }
                    }
                  }
                }
              }
            },
            "resource_access": {
              "type": "object",
              "properties": {
                "allowed": {
                  "type": "boolean"
                },
                "servers": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "restricted_servers": {
                  "type": "array",
                  "items": { "type": "string" }
                }
              }
            }
          }
        }
      }
    },
    "security": {
      "type": "object",
      "properties": {
        "secret_detection": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "patterns": {
              "type": "array",
              "items": { "type": "string" }
            },
            "action": {
              "type": "string",
              "enum": ["warn", "block", "log"]
            },
            "scan_on_write": {
              "type": "boolean"
            },
            "scan_on_commit": {
              "type": "boolean"
            }
          }
        },
        "audit": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "log_file_operations": {
              "type": "boolean"
            },
            "log_network_requests": {
              "type": "boolean"
            },
            "log_system_commands": {
              "type": "boolean"
            },
            "log_git_operations": {
              "type": "boolean"
            },
            "retention_days": {
              "type": "integer",
              "minimum": 1
            }
          }
        },
        "sandbox": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "isolate_filesystem": {
              "type": "boolean"
            },
            "isolate_network": {
              "type": "boolean"
            },
            "isolate_processes": {
              "type": "boolean"
            }
          }
        }
      }
    },
    "project_security": {
      "type": "object",
      "properties": {
        "secret_detection": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "patterns": {
              "type": "array",
              "items": { "type": "string" }
            },
            "action": {
              "type": "string",
              "enum": ["warn", "block", "log"]
            },
            "scan_on_write": { "type": "boolean" },
            "scan_on_commit": { "type": "boolean" }
          }
        },
        "dependency_security": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "scan_dependencies": { "type": "boolean" },
            "check_vulnerabilities": { "type": "boolean" },
            "block_vulnerable_packages": { "type": "boolean" },
            "warn_on_vulnerabilities": { "type": "boolean" }
          }
        },
        "code_quality": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "require_tests": { "type": "boolean" },
            "require_linting": { "type": "boolean" },
            "require_formatting": { "type": "boolean" },
            "warn_on_quality_issues": { "type": "boolean" }
          }
        }
      }
    },
    "development_restrictions": {
      "type": "object",
      "properties": {
        "hot_reload": {
          "type": "object",
          "properties": {
            "allowed": { "type": "boolean" },
            "max_file_changes": { "type": "integer", "minimum": 1 },
            "scan_interval": { "type": "integer", "minimum": 100 }
          }
        },
        "auto_save": {
          "type": "object",
          "properties": {
            "allowed": { "type": "boolean" },
            "interval": { "type": "integer", "minimum": 1000 },
            "exclude_patterns": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        },
        "background_tasks": {
          "type": "object",
          "properties": {
            "allowed": { "type": "boolean" },
            "max_concurrent": { "type": "integer", "minimum": 1 },
            "allowed_tasks": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        }
      }
    },
    "platform_overrides": {
      "type": "object",
      "patternProperties": {
        "^(windows|darwin|linux)$": {
          "type": "object",
          "properties": {
            "permissions": {
              "type": "object",
              "description": "Platform-specific permission overrides"
            }
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "created": {
          "type": "string",
          "format": "date-time"
        },
        "updated": {
          "type": "string",
          "format": "date-time"
        },
        "author": {
          "type": "string"
        },
        "license": {
          "type": "string"
        },
        "project_scope": {
          "type": "boolean"
        }
      }
    }
  }
}